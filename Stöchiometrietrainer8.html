<!DOCTYPE html>
<html lang="de">
<head>
    
    <link rel="icon" type="image/vnd.microsoft.icon" href="HP2.ico">
    <title>Stöchiometrie 8</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <style> input{ width:150px; font-size:20px; text-align: center;}
        
        .small{ width:50px; font-size:20px; text-align: center;}
        .ElementTabelle{ border-color: black;border: 1px solid; width:50%; margin:10px auto;}
        .ElementTabelle td{ border-color: black;border: 1px solid;}
        .ElementTabelle tr{ border-color: black;border: 1px solid;}
        td{ white-space: nowrap;}
        li{display: inline-block; margin-right: 5px; padding:10px; border: 1px solid black;border-radius: 5px;font-size: 18px;}
        .image {margin-left: 20px; margin-right: 20px; box-shadow: 11px 12px 13px 7px rgba(0,0,0,0.67); }
        .Haupttabelle{font-size: x-large; text-align: center; width: 80%; height: 100%; margin-left: auto; margin-right: auto;}
        input[type="button"]{ padding: 7px; box-shadow: 5px 5px 10px 5px rgba(0,0,0,0.67);background-color: burlywood;border-radius: 10px;}
        button{padding: 5px; box-shadow: 5px 5px 10px 5px rgba(0,0,0,0.67);background-color: burlywood;border-radius: 10px;}
        input[type="button"]:hover{ padding: 7px; box-shadow: 5px 5px 10px 5px rgba(0,0,0,0.67);background-color: rgba(223, 196, 161, 0.555);}
        body{background-color: rgba(193, 247, 239, 0.336);}
        #Anzeiger{display: flex; border: 1px solid black;margin: auto;width: fit-content; background-color: rgba(176, 181, 189, 0.438);vertical-align: auto; white-space: nowrap;}
        h2{ font-size: 40px;}
        footer {  padding: -0.4em;  bottom: 0.0em;  left: 0;  right: 0; text-align: center;}
        nav > input{
                display: none;
            }
    
            ul{
                display: none;
                margin: 0;
                padding: 5px;
            }
            input[type=checkbox]:checked ~ ul {
                display: block;
            }
            nav li{display:flex;
                margin-right: 0px;
                padding:0px;
                border: 0;
                border-radius: 0px;
            }
            .OC td{
            border: 1px solid;
            border-collapse: collapse;
          }
          .center{
            display: block;
            margin-left: auto;
            margin-right: auto;
            
          }
          .Infos{
            width: auto;
          }
          .cat{
      margin: 4px;
      background-color: #104068;
      border-radius: 4px;
      border: 1px solid #fff;
      overflow: hidden;
      float: left;
    }
          div label input {margin-right: 100px;}
          .container{width: 250px; height: 38px; margin: 100px auto;}
    
          .cat{
      margin: 4px;
      background-color: #104068;
      border-radius: 4px;
      border: 1px solid #fff;
      overflow: hidden;
      float: left;
    }
    
    .cat label {
      float: left; line-height: 3.0em;
      width: 12.0em; height: 3.0em;
    }
    
    .cat label span {
      text-align: center;
      padding: 3px 0;
      display: block;
    }
    
    .cat label input {
      position: absolute;
      display: none;
      color: #fff !important;
    }
    /* selects all of the text within the input element and changes the color of the text */
    .cat label input + span{color: #fff;}
    
    
    /* This will declare how a selected input will look giving generic properties */
    .cat input:checked + span {
        background-color: #82D44E;
        color: #ffffff;
        text-shadow: 0 0  6px rgba(0, 0, 0, 0.8);
    }
    #ZurückZumStart{ display: flex; width: 50px; height: 50px;    position: absolute;
    top: 20px;
    left: 20px;}
            </style>
    
    
</head>
<body>
    <h2 style="text-align: center;">Reaktionsgleichungen mit Stöchiometrie</td></h2>
    <div id="ZurückZumStart"><a href="https://reinmuth.github.io/Startseite-Trainer.html"><img src="img/back-arrow.png" width="50px"></a></div>

     
    <nav class="dropdown" style="position: absolute;right: 2%; top: 2%;"> 
        <input type="checkbox" id="checkbox_toggle" onclick="MenüAnzeigen()">
        <label style="margin-left: 85%;margin-right: 13em;"  for="checkbox_toggle"><img src="img/menu.png" width="30px" alt="toggle menue"/></label>
        <ul id="ListenMenü" style="background-color: darkcyan;">
        <li><div class="cat Allgemein">
                <label>
                   <input id="Ausw0" type="checkbox" checked value="1"><span>Einfache Reaktionen</span>
                </label>
             </div></li>
        <li><div class="cat Oxidation">
            <label>
               <input id="Ausw1" type="checkbox"  value="0"><span>Verbrennungen/Oxidationen</span>
            </label>
         </div></li>
        <li><div class="cat Wasserstoff">
            <label>
               <input id="Ausw2" type="checkbox"  value="0"><span>Wasserstoff und Wasser</span>
            </label>
         </div></li>
        <!-- <li><div class="cat Substitution">
            <label>
               <input id="Ausw3" type="checkbox" checked value="1"><span>Substitutionsreaktion</span>
            </label>
         </div></li>
        <li><div class="cat Additionsreaktion">
            <label>
               <input id="Ausw4" type="checkbox" checked value="1"><span>Additionsreaktion</span>
            </label>
         </div></li>
        <li><div class="cat Alkanole">
            <label>
               <input id="Ausw5" type="checkbox" checked value="1"><span>Oxidation Alkanole</span>
            </label>
         </div></li>
        <li><div class="cat Aldehyde">
            <label>
               <input id="Ausw6" type="checkbox" checked value="1"><span>Alkanale/Alkanone</span>
            </label>
         </div></li>
        <li>  <div class="cat Alkansäuren">
            <label>
               <input id="Ausw7" type="checkbox" checked value="1"><span>Alkansäuren</span>
            </label>
         </div></li> -->
        <li><div class="cat Auswahl">
            <label>
               <input type="button" onclick="Abwählaktion()"><span>Alles ab-/anwählen</span>
            </label>
         </div></li>        
         <li><div class="cat Speichern">
            <label>
               <input type="button" onclick="Speichern()"><span>Zurück</span>
            </label>
         </div></li>
        </ul>
        </nav>
 
    <div style="display:flex; align-items: center; align-content: center;margin: auto; text-align: center;width: fit-content;"><h3 style="width: fit-content;text-align: center;padding: 0 6px; color: coral;font-size:x-large;" id="Aufgabenstellung"></h3><button value="Neuladen" onclick=NeueAufgabeStarten()><img src="img/refresh.png" width="25px"></button></div>

    <div style="text-align: center; box-sizing: border-box;">
        <table class="Haupttabelle">
            <tbody id ="myTable">

            </tbody>

        </table>
        <p>&ensp; </p>


         <input type="button" value="Überprüfen" onclick=Überprüfen()>
        <p id = "LebensAnzeige">&ensp; </p>
        <p id="AntwortSatz"></p>
        
        <div style="align-items: center; font-size: 20px;"><p id="Hilfestellung"></p></div>
        
        <div id="Bilder">
            
        </div>
        <div  style="margin-top: 5em; bottom:0cm;" id="Anzeiger" class="Fortschrittsleiste">
        
            <ol>
                <li style="border: 0">Fortschrittsleiste</li> 
                <li id="Anz0" >1. Verhältnisformel</li>
                <li id="Anz1" >2. Ausgleichen</li>
                <li id="Anz2" >3. Molare Massen</li>
                <li id="Anz3" >4. Stoffmengen</li>
                <li id="Anz4" >5. Massen</li>
            </ol>
         </div>
    </div>

<script>
    var level = 0;
    var AuswahlListeSichtbar = false;
    var AufgabenArray = [];
    var KategorienArray = new Array(3);
    Speichern();

    var textbool = 0;
    var salzErklärung = 0;
    document.getElementById("Bilder").innerHTML="";
    var failCounter = 0;
    // LebensAnzeiger();
        var meinArray = [];
        meinArray.push([0,"Elementsymbol","Masse","PSE-Bild.jpg"]);
            meinArray.push([1,"H",1,"PSE-H.jpg"]);
            meinArray.push([2,"He",4,"PSE-He.jpg"]);
            meinArray.push([3,"Li",7,"PSE-Li.jpg"]);
            meinArray.push([4,"Be",9,"PSE-Be.jpg"]);
            meinArray.push([5,"B",11,"PSE-B.jpg"]);
            meinArray.push([6,"C",12,"PSE-C.jpg"]);
            meinArray.push([7,"N",14,"PSE-N.jpg"]);
            meinArray.push([8,"O",16,"PSE-O.jpg"]);
            meinArray.push([9,"F",19,"PSE-F.jpg"]);
            meinArray.push([10,"Ne",20,"PSE-Ne.jpg"]);
            meinArray.push([11,"Na",23,"PSE-Na.jpg"]);
            meinArray.push([12,"Mg",24,"PSE-Mg.jpg"]);
            meinArray.push([13,"Al",27,"PSE-Al.jpg"]);
            meinArray.push([14,"Si",28,"PSE-Si.jpg"]);
            meinArray.push([15,"P",31,"PSE-P.jpg"]);
            meinArray.push([16,"S",32,"PSE-S.jpg"]);
            meinArray.push([17,"Cl",35,"PSE-Cl.jpg"]);
            meinArray.push([18,"Ar",40,"PSE-Ar.jpg"]);
            meinArray.push([19,"K",39,"PSE-K.jpg"]);
            meinArray.push([20,"Ca",40,"PSE-Ca.jpg"]);
            meinArray.push([21,"Sc",45,"PSE-Sc.jpg"]);
            meinArray.push([22,"Ti",48,"PSE-Ti.jpg"]);
            meinArray.push([23,"V",51,"PSE-V.jpg"]);
            meinArray.push([24,"Cr",52,"PSE-Cr.jpg"]);
            meinArray.push([25,"Mn",55,"PSE-Mn.jpg"]);
            meinArray.push([26,"Fe",56,"PSE-Fe.jpg"]);
            meinArray.push([27,"Co",59,"PSE-Co.jpg"]);
            meinArray.push([28,"Ni",59,"PSE-Ni.jpg"]);
            meinArray.push([29,"Cu",64,"PSE-Cu.jpg"]);
            meinArray.push([30,"Zn",65,"PSE-Zn.jpg"]);
            meinArray.push([31,"Ga",70,"PSE-Ga.jpg"]);
            meinArray.push([32,"Ge",72,"PSE-Ge.jpg"]);
            meinArray.push([33,"As",75,"PSE-As.jpg"]);
            meinArray.push([34,"Se",79,"PSE-Se.jpg"]);
            meinArray.push([35,"Br",80,"PSE-Br.jpg"]);
            meinArray.push([36,"Kr",84,"PSE-Kr.jpg"]);
            meinArray.push([37,"Rb",85,"PSE-Rb.jpg"]);
            meinArray.push([38,"Sr",88,"PSE-Sr.jpg"]);
            meinArray.push([39,"Y",89,"PSE-Y.jpg"]);
            meinArray.push([40,"Z",91,"PSE-Z.jpg"]);
            meinArray.push([41,"Nb",93,"PSE-Nb.jpg"]);
            meinArray.push([42,"Mo",96,"PSE-Mo.jpg"]);
            meinArray.push([43,"Tc",98,"PSE-Tc.jpg"]);
            meinArray.push([44,"Ru",101,"PSE-Ru.jpg"]);
            meinArray.push([45,"Rh",103,"PSE-Rh.jpg"]);
            meinArray.push([46,"Pd",106,"PSE-Pd.jpg"]);
            meinArray.push([47,"Ag",108,"PSE-Ag.jpg"]);
            meinArray.push([48,"Cd",112,"PSE-Cd.jpg"]);
            meinArray.push([49,"In",115,"PSE-In.jpg"]);
            meinArray.push([50,"Sn",119,"PSE-Sn.jpg"]);
            meinArray.push([51,"Sb",122,"PSE-Sb.jpg"]);
            meinArray.push([52,"Te",128,"PSE-Te.jpg"]);
            meinArray.push([53,"I",127,"PSE-I.jpg"]);
            meinArray.push([54,"Xe",131,"PSE-Xe.jpg"]);
            meinArray.push([55,"Cs",133,"PSE-Cs.jpg"]);
            meinArray.push([56,"Ba",137,"PSE-Ba.jpg"]);
            meinArray.push([57,"La",139,"PSE-La.jpg"]);
            meinArray.push([72,"Hf",178,"PSE-Hf.jpg"]);
            meinArray.push([73,"Ta",181,"PSE-Ta.jpg"]);
            meinArray.push([74,"W",184,"PSE-W.jpg"]);
            meinArray.push([75,"Re",186,"PSE-Re.jpg"]);
            meinArray.push([76,"Os",190,"PSE-Os.jpg"]);
            meinArray.push([77,"Ir",192,"PSE-Ir.jpg"]);
            meinArray.push([78,"Pt",195,"PSE-Pt.jpg"]);
            meinArray.push([79,"Au",197,"PSE-Au.jpg"]);
            meinArray.push([80,"Hg",201,"PSE-Hg.jpg"]);
            meinArray.push([81,"Tl",204,"PSE-Tl.jpg"]);
            meinArray.push([82,"Pb",207,"PSE-Pb.jpg"]);
            meinArray.push([83,"Bi",209,"PSE-Bi.jpg"]);
            meinArray.push([84,"Po",210,"PSE-Po.jpg"]);
            meinArray.push([85,"At",210,"PSE-At.jpg"]);
            meinArray.push([86,"Rn",222,"PSE-Rn.jpg"]);
            meinArray.push([87,"Fr",223,"PSE-Fr.jpg"]);
            meinArray.push([88,"Ra",226,"PSE-Ra.jpg"]);
            meinArray.push([0,"J",0,"PSE-J.jpg"]); // Elementarladung
    var SchonArray = [];
    var ZählArrayE = [];
    var ZählArrayP = [];
    var Stoffmenge;
    Stoffmenge = Math.floor(Math.random()*11+1)/2;
    AufgabenArrayFestleger();
    
    var Nummer = Math.floor(Math.random()*AufgabenArray.length);
    var Reaktionsarray = AufgabenArray[Nummer];
    document.getElementById("myTable").innerHTML = "";

    Start();

function AufgabenArrayFestleger(){
     AufgabenArray = [];
        if (KategorienArray[0] == true){   //Allgemein
            AufgabenArray.push([[["CuO", "Kupfer(II)-Oxid"],["Mg","Magnesium"]],[["Cu", "Kupfer"],["MgO","Magnesiumoxid"]]]);
            AufgabenArray.push([[["N2","Stickstoff"],["Mg", "Magnesium"]],[["Mg3N2", "Magnesiumnitrid"]]]);
            AufgabenArray.push([[["Na", "Natrium"],["Cl2","Chlor"]],[["NaCl", "Natriumchlorid"]]]);
            AufgabenArray.push([[["Al", "Aluminium"],["F2","Fluor"]],[["AlF3", "Aluminiumfluorid"]]]);
            AufgabenArray.push([[["Mg", "Magnesium"],["F2","Fluor"]],[["MgF2", "Magnesiumfluorid"]]]);
            
            AufgabenArray.push([[["Mg", "Magnesium"],["Cl2","Chlor"]],[["MgCl2", "Magnesiumchlorid"]]]);
            AufgabenArray.push([[["Mg", "Magnesium"],["Br2","Brom"]],[["MgBr2", "Magnesiumbromid"]]]);
            AufgabenArray.push([[["Ca", "Calcium"],["Br2","Brom"]],[["CaBr2", "Calciumbromid"]]]);
            AufgabenArray.push([[["Ca", "Calcium"],["F2","Fluor"]],[["CaF2", "Calciumfluorid"]]]);
            //AufgabenArray.push([[["Ca", "Calcium"],["I2","Iod"]],[["CaI2", "Calciumiodid"]]]);
            AufgabenArray.push([[["Ca", "Calcium"],["Cl2","Chlor"]],[["CaCl2", "Calciumchlorid"]]]);
            AufgabenArray.push([[["Mg", "Magnesium"],["S8","Schwefel"]],[["MgS", "Magnesiumsulfid"]]]);
            AufgabenArray.push([[["Ca", "Calcium"],["S8","Schwefel"]],[["CaS", "Calciumsulfid"]]]);
            AufgabenArray.push([[["Be", "Beryllium"],["S8","Schwefel"]],[["BeS", "Berylliumsulfid"]]]);
            //AufgabenArray.push([[["Cu", "Kupfer"],["S8","Schwefel"]],[["CuS", "Kupfer(II)sulfid"]]]);
            //AufgabenArray.push([[["Cu", "Kupfer"],["S8","Schwefel"]],[["Cu2S", "Kupfer(I)sulfid"]]]);
            //AufgabenArray.push([[["Cu2O", "Kupfer(I)oxid"],["Zn","Zink"]],[["Cu", "Kupfer"],["ZnO","Zink(II)oxid"]]]);
            //AufgabenArray.push([[["CuO", "Kupfer(II)oxid"],["Fe","Eisen"]],[["Fe2O3", "Eisen(III)oxid"],["Cu","Kupfer"]]]);
            AufgabenArray.push([[["Al", "Aluminium"],["MgO", "Magnesiumoxid"]],[["Al2O3", "Aluminiumoxid"],["Mg","Magnesium"]]]);
            //AufgabenArray.push([[["Mg", "Magnesium"],["I2","Iod"]],[["MgI2", "Magnesiumiodid"]]]);

        }
        if (KategorienArray[1] == true){ //Oxidationen / Verbrennungen
            AufgabenArray.push([[["Cu", "Kupfer"],["O2","Sauerstoff"]],[["CuO", "Kupfer(II)oxid"]]]);
            AufgabenArray.push([[["Ag", "Silber"],["O2","Sauerstoff"]],[["Ag2O", "Silber(I)oxid"]]]);
            AufgabenArray.push([[["FeS", "Eisen(II)sulfid"],["O2","Sauerstoff"]],[["Fe2O3", "Eisen(III)oxid"],["SO2","Schwefeldioxid"]]]);
            AufgabenArray.push([[["C", "Kohlenstoff"],["O2", "Sauerstoff"]],[["CO2", "Kohlenstoffdioxid"]]]);
            AufgabenArray.push([[["C", "Kohlenstoff"],["O2", "Sauerstoff"]],[["CO", "Kohlenstoffmonoxid"]]]);
            AufgabenArray.push([[["Ag2O", "Silber(I)-Oxid"],["C","Kohlenstoff"]],[["Ag", "Silber"],["CO2","Kohlenstoffdioxid"]]]);
            AufgabenArray.push([[["CuO", "Kuper(II)-Oxid"],["C","Kohlenstoff"]],[["Cu", "Kupfer"],["CO2","Kohlenstoffdioxid"]]]);
            AufgabenArray.push([[["FeO", "Eisen(II)oxid"],["C","Kohlenstoff"]],[["Fe", "Eisen"],["CO2","Kohlenstoffdioxid"]]]);
            AufgabenArray.push([[["Mg", "Magnesium"],["CO2","Kohlenstoffdioxid"]],[["MgO","Magnesiumoxid"],["C","Kohlenstoff"]]]);
            AufgabenArray.push([[["Mg", "Magnesium"],["O2","Sauerstoff"]],[["MgO","Magnesiumoxid"]]]);
            AufgabenArray.push([[["Ca", "Calcium"],["O2","Sauerstoff"]],[["CaO","Calciumoxid"]]]);
            AufgabenArray.push([[["Fe2O3", "Eisen(III)oxid"],["CO", "Kohlenstoffmonoxid"]],[["Fe","Eisen"],["CO2","Kohlenstoffdioxid"]]]);
            AufgabenArray.push([[["CO", "Kohlenstoffmonoxid"]],[["C", "Kohlenstoff"],["CO2","Kohlenstoffdioxid"]]]);
            AufgabenArray.push([[["Zn", "Zink"],["O2", "Sauerstoff"]],[["ZnO","Zink(II)oxid"]]]);
            AufgabenArray.push([[["Al2O3", "Aluminiumoxid"],["SO", "Schwefelmonoxid"]],[["Al", "Aluminium"],["SO3","Schwefeltrioxid"]]]);




        }
        if (KategorienArray[2] == true){ //Wasserstoff und Wasser
            AufgabenArray.push([[["H2", "Wasserstoff"],["O2", "Sauerstoff"]],[["H2O", "Wasser"]]]);
            AufgabenArray.push([[["CO", "Kohlenstoffmonoxid"],["H2O", "Wasser"]],[["CO2","Kohlenstoffdioxid"],["H2","Wasserstoff"]]]);
            AufgabenArray.push([[["MgO","Magnesiumoxid"],["HCl", "Chlorwasserstoff"]],[["MgCl2", "Magnesiumchlorid"],["H2O", "Wasser"]]]);
            AufgabenArray.push([[["H3O+", "Oxoniumion"],["OH-","Hydroxidion"]],[["H2O", "Wasser"]]]);
            AufgabenArray.push([[["CuO", "Kuper(II)-Oxid"],["H2","Wasserstoff"]],[["Cu", "Kupfer"],["H2O","Wasser"]]]);

            
        }
  




    




}



function MenüAnzeigen(){

document.getElementById("checkbox_toggle").onlick = 'Speichern()';

}

function Start(){ 
failCounter = 0;
// LebensAnzeiger();

document.getElementById("Hilfestellung").innerHTML="";
FarbEinsteller();
document.getElementById("Bilder").innerHTML="";
var table = document.getElementById("myTable");
var Inneres ="";
Inneres = "<tr><td>Reaktionsschema:</td>";
for ( i = 0;  i < Reaktionsarray[0].length ; i++){
    Inneres += "<td>"+ Reaktionsarray[0][i][1]+"</td>";
    if ( i != Reaktionsarray[0].length-1 ){
        Inneres += "<td>+</td>";
    } else {
        Inneres += "<td>&#10141;</td>";
    }
}
for ( i = 0;  i < Reaktionsarray[1].length ; i++){
    Inneres += "<td>"+ Reaktionsarray[1][i][1]+"</td>";
    if ( i != Reaktionsarray[1].length-1 ){
        Inneres += "<td>+</td>";
    } 
}



if (level == 1){
document.getElementById("Aufgabenstellung").innerHTML="Aufgabe: Gleiche die Reaktionsgleichung aus mithilfe der Vorfaktoren.";
document.getElementById("Hilfestellung").innerHTML="Hinweis: Die Faktoren können als Dezimalzahlen (z.B. 0,5) oder als Brüche (z.B: 1/2) eingegeben werden. ";
Inneres += "<tr><td>Reaktionsgleichung:</td>";
for ( j = 0;  j < Reaktionsarray[0].length ; j++){
    var id = "ZahlE"+j;
    Inneres += "<td> <input class='small' id="+id+" > "+ SchöneSummenformel(Reaktionsarray[0][j][0])+"</td>";
    if ( j != Reaktionsarray[0].length-1 ){
        Inneres += "<td>+</td>";
    } else {
        Inneres += "<td>&#10141;</td>";
    }
}
for ( j = 0;  j < Reaktionsarray[1].length ; j++){
    var id = "ZahlP"+j;
    Inneres += "<td> <input class='small' id="+id+" > "+ SchöneSummenformel(Reaktionsarray[1][j][0])+"</td>";
    if ( j != Reaktionsarray[1].length-1 ){
        Inneres += "<td>+</td>";
    }
} 
Inneres += "</tr>";
} else if (level == 0 ){
document.getElementById("Aufgabenstellung").innerHTML="Aufgabe: Ergänze die Summenformeln der einzelnen Stoffe.";
document.getElementById("AntwortSatz").innerHTML = "";
document.getElementById("Hilfestellung").innerHTML="Hinweis: Gib Summenformeln folgendermaßen ein: z.B. H2O (wird zu H<sub>2</sub>O),  Cu^2+ (wird zu Cu<sup>2+</sup>)";
Inneres += "<tr><td>Reaktionsgleichung:</td>";
for ( i = 0;  i < Reaktionsarray[0].length ; i++){
    var id = "";
    id = "E"+i;
    Inneres += '<td> <input oninput="KoeffizientenVerkleinern(this.id)" id='+id+' placeholder="Summenformel"> </td>';
    if ( i != Reaktionsarray[0].length-1 ){
        Inneres += "<td>+</td>";
    } else {
        Inneres += "<td>&#10141;</td>";
    }
}
for ( i = 0;  i < Reaktionsarray[1].length ; i++){
    var id = "";
    id = "P"+i;
    Inneres += '<td> <input oninput="KoeffizientenVerkleinern(this.id)" id='+id+' placeholder="Summenformel"> </td>';
    if ( i != Reaktionsarray[1].length-1 ){
        Inneres += "<td>+</td>";
    }
}
Inneres += "</tr>";

} else if (level == 2) {
document.getElementById("Aufgabenstellung").innerHTML="Aufgabe: Bestimme die molaren Massen aller beteiligten Stoffe.";
document.getElementById("Hilfestellung").innerHTML="Hinweis: Wir runden die Massezahl auf eine ganze Zahl. ";
FaktorenEintrager();

bilderEinfüger(SchonArray);
Inneres += "<tr><td>Reaktionsgleichung:</td>";
for ( j = 0;  j < Reaktionsarray[0].length ; j++){
    Reaktionsarray[0][j].push(molareMasseRechner(formelZerstückler(Reaktionsarray[0][j][0])));


    Inneres += "<td>"+Reaktionsarray[0][j][2] +" &ensp; "+ SchöneSummenformel(Reaktionsarray[0][j][0])+"</td>";
    if ( j != Reaktionsarray[0].length-1 ){
        Inneres += "<td>+</td>";
    } else {
        Inneres += "<td>&#10141;</td>";
    }
}
for ( j = 0;  j < Reaktionsarray[1].length ; j++){
    Reaktionsarray[1][j].push(molareMasseRechner(formelZerstückler(Reaktionsarray[1][j][0])));
    Inneres += "<td> "+Reaktionsarray[1][j][2]+" &ensp; "+ SchöneSummenformel(Reaktionsarray[1][j][0])+"</td>";
    if ( j != Reaktionsarray[1].length-1 ){
        Inneres += "<td>+</td>";
    }
} 
Inneres += "</tr>";

Inneres += "<tr><td>Molare Masse:</td>";
for ( j = 0;  j < Reaktionsarray[0].length ; j++){
    var id = "MoMaE"+j;
    Inneres += '<td> <label>M('+SchöneSummenformel(Reaktionsarray[0][j][0])+') = </label><input class="small" id='+id+' > <math><mfrac><mn>g</mn><mn>mol</mn></mfrac></math></td>';
    if ( j != Reaktionsarray[0].length-1 ){
        Inneres += "<td> &ensp;  </td>";
    } else {
        Inneres += "<td> &ensp; </td>";
    }
}
for ( j = 0;  j < Reaktionsarray[1].length ; j++){
    var id = "MoMaP"+j;
    Inneres += '<td> <label>M('+SchöneSummenformel(Reaktionsarray[1][j][0])+') = </label><input class="small" id='+id+' > <math><mfrac><mn>g</mn><mn>mol</mn></mfrac></math> </td>';
    if ( j != Reaktionsarray[1].length-1 ){
        Inneres += "<td> &ensp; </td>";
    }
} 
Inneres += "</tr>";
} else if (level == 3 ){
document.getElementById("Aufgabenstellung").innerHTML="Aufgabe: Bestimme alle gesuchten Stoffmengen.";
document.getElementById("Hilfestellung").innerHTML="Hinweis: Berechne dafür zunächst die Stoffmenge n("+SchöneSummenformel( Reaktionsarray[0][0][0])+") und bestimme dann die übrigen Stoffmengen. <br> Die Zahlen können als Dezimalzahlen (z.B. 0,5) oder als Brüche (z.B: 1/2) eingegeben werden.";
Inneres += "<tr><td>Reaktionsgleichung:</td>";
for ( j = 0;  j < Reaktionsarray[0].length ; j++){
    var id = "SpanE"+j;
    Inneres += "<td><span id="+id+">"+Reaktionsarray[0][j][2] +"</span> &ensp; "+ SchöneSummenformel(Reaktionsarray[0][j][0])+"</td>";
    if ( j != Reaktionsarray[0].length-1 ){
        Inneres += "<td>+</td>";
    } else {
        Inneres += "<td>&#10141;</td>";
    }
}
for ( j = 0;  j < Reaktionsarray[1].length ; j++){
    var id = "SpanP"+j;
    Inneres += "<td> <span id="+id+">"+Reaktionsarray[1][j][2]+"</span> &ensp; "+ SchöneSummenformel(Reaktionsarray[1][j][0])+"</td>";
    if ( j != Reaktionsarray[1].length-1 ){
        Inneres += "<td>+</td>";
    }
} 
Inneres += "</tr>";

Inneres += "<tr><td>Molare Masse:</td>";
for ( j = 0;  j < Reaktionsarray[0].length ; j++){
    var id = "MoMaE"+j;
    Inneres += '<td> <label>M('+SchöneSummenformel(Reaktionsarray[0][j][0])+') = </label>'+Reaktionsarray[0][j][3]+' <math><mfrac><mn>g</mn><mn>mol</mn></mfrac></math>  </td>';
    if ( j != Reaktionsarray[0].length-1 ){
        Inneres += "<td> &ensp;  </td>";
    } else {
        Inneres += "<td> &ensp; </td>";
    }
}
for ( j = 0;  j < Reaktionsarray[1].length ; j++){
    var id = "MoMaP"+j;
    Inneres += '<td> <label>M('+SchöneSummenformel(Reaktionsarray[1][j][0])+') = </label>'+Reaktionsarray[1][j][3]+' <math><mfrac><mn>g</mn><mn>mol</mn></mfrac></math>  </td>';
    if ( j != Reaktionsarray[1].length-1 ){
        Inneres += "<td> &ensp; </td>";
    }
} 
Inneres += "</tr>";
Inneres += "<tr><td>Stoffmenge n:</td>";
for ( j = 0;  j < Reaktionsarray[0].length ; j++){
    var id = "NE"+j;
    Reaktionsarray[0][j].push(Stoffmenge * Reaktionsarray[0][j][2]/Reaktionsarray[0][0][2]);
    
    
    Inneres += '<td> <label <span id="Span'+id+'">n('+SchöneSummenformel(Reaktionsarray[0][j][0])+') </span></label> = <input class="small" id='+id+' > mol</td>';
    if ( j != Reaktionsarray[0].length-1 ){
        Inneres += "<td> &ensp;  </td>";
    } else {
        Inneres += "<td> &ensp; </td>";
    }
}
for ( j = 0;  j < Reaktionsarray[1].length ; j++){
    var id = "NP"+j;
    Reaktionsarray[1][j].push(Stoffmenge * Reaktionsarray[1][j][2]/Reaktionsarray[0][0][2]);
    Inneres += '<td> <label> <span id="Span'+id+'"> n('+SchöneSummenformel(Reaktionsarray[1][j][0])+') </span></label> = <input class="small" id='+id+' > mol</td>';
    if ( j != Reaktionsarray[1].length-1 ){
        Inneres += "<td> &ensp; </td>";
    }
} 
Inneres += "</tr>";
Inneres += "<tr><td>Masse m:</td>";

    var MasseZahl = Stoffmenge * Reaktionsarray[0][0][3];
    Inneres += "<td> m("+SchöneSummenformel(Reaktionsarray[0][0][0])+ ") = "+AusgabeMitKomma(MasseZahl) +" g </td>";
Inneres += "</tr>";




}else if (level == 4 ){
    document.getElementById("Aufgabenstellung").innerHTML="Aufgabe: Berechne die übrigen Massen.";
    Inneres += "<tr><td>Reaktionsgleichung:</td>";
    for ( j = 0;  j < Reaktionsarray[0].length ; j++){

        Inneres += "<td>"+Reaktionsarray[0][j][2] +" &ensp; "+ SchöneSummenformel(Reaktionsarray[0][j][0])+"</td>";
        if ( j != Reaktionsarray[0].length-1 ){
            Inneres += "<td>+</td>";
        } else {
            Inneres += "<td>&#10141;</td>";
        }
    }
    for ( j = 0;  j < Reaktionsarray[1].length ; j++){
        
        Inneres += "<td> "+Reaktionsarray[1][j][2]+" &ensp; "+ SchöneSummenformel(Reaktionsarray[1][j][0])+"</td>";
        if ( j != Reaktionsarray[1].length-1 ){
            Inneres += "<td>+</td>";
        }
    } 
    Inneres += "</tr>";

    Inneres += "<tr><td>Molare Masse M:</td>";
    for ( j = 0;  j < Reaktionsarray[0].length ; j++){
        var id = "MoMaE"+j;
        Inneres += '<td> <label>M('+SchöneSummenformel(Reaktionsarray[0][j][0])+') = </label>'+Reaktionsarray[0][j][3]+' <math><mfrac><mn>g</mn><mn>mol</mn></mfrac></math></td>';
        if ( j != Reaktionsarray[0].length-1 ){
            Inneres += "<td> &ensp;  </td>";
        } else {
            Inneres += "<td> &ensp; </td>";
        }
    }
    for ( j = 0;  j < Reaktionsarray[1].length ; j++){
        var id = "MoMaP"+j;
        Inneres += '<td> <label>M('+SchöneSummenformel(Reaktionsarray[1][j][0])+') = </label>'+Reaktionsarray[1][j][3]+' <math><mfrac><mn>g</mn><mn>mol</mn></mfrac></math></td>';
        if ( j != Reaktionsarray[1].length-1 ){
            Inneres += "<td> &ensp; </td>";
        }
    } 
    Inneres += "</tr>";
    Inneres += "<tr><td>Stoffmenge n:</td>";
    for ( j = 0;  j < Reaktionsarray[0].length ; j++){
        var id = "NE"+j;
        
        Inneres += '<td> <label>n('+SchöneSummenformel(Reaktionsarray[0][j][0])+') = </label>'+AusgabeMitKomma(Reaktionsarray[0][j][4])+' mol </td>';
        if ( j != Reaktionsarray[0].length-1 ){
            Inneres += "<td> &ensp;  </td>";
        } else {
            Inneres += "<td> &ensp; </td>";
        }
    }
    for ( j = 0;  j < Reaktionsarray[1].length ; j++){
        
        
        Inneres += '<td> <label>n('+SchöneSummenformel(Reaktionsarray[1][j][0])+') = </label>'+AusgabeMitKomma(Reaktionsarray[1][j][4])+' mol  </td>';
        if ( j != Reaktionsarray[1].length-1 ){
            Inneres += "<td> &ensp; </td>";
        }
    } 
    Inneres += "</tr>";
    Inneres += "<tr><td>Masse m:</td>";
        var MasseZahl = Stoffmenge * Reaktionsarray[0][0][3];
        Inneres += "<td> m("+SchöneSummenformel(Reaktionsarray[0][0][0])+ ") = "+AusgabeMitKomma(MasseZahl) +" g </td>";
        Reaktionsarray[0][0].push(MasseZahl);
        Inneres += "<td> &ensp;  </td>";
    for ( j = 1;  j < Reaktionsarray[0].length ; j++){
        var id = "mE"+j;
        Reaktionsarray[0][j].push(Reaktionsarray[0][j][3] * Reaktionsarray[0][j][4]);
        Inneres += '<td> <label>m('+SchöneSummenformel(Reaktionsarray[0][j][0])+') = </label><input class="small" id='+id+' > g</td>';
        if ( j != Reaktionsarray[0].length-1 ){
            Inneres += "<td> &ensp;  </td>";
        } else {
            Inneres += "<td> &ensp; </td>";
        }
    }
    for ( j = 0;  j < Reaktionsarray[1].length ; j++){
        var id = "mP"+j;
        Reaktionsarray[1][j].push(Reaktionsarray[1][j][3] * Reaktionsarray[1][j][4]);
        Inneres += '<td> <label>m('+SchöneSummenformel(Reaktionsarray[1][j][0])+') = </label><input class="small" id='+id+' > g</td>';
        if ( j != Reaktionsarray[1].length-1 ){
            Inneres += "<td> &ensp; </td>";
        }
    } 



    Inneres += "</tr>";


}

document.getElementById("myTable").innerHTML = Inneres;

}



function Abwählaktion(){
    for (let i = 0; i<KategorienArray.length; i++){
        KategorienArray[i]=document.getElementById("Ausw"+i).checked;
    }
    if (KategorienArray.includes(true) == false){
        for (let i = 0; i<KategorienArray.length; i++){
        document.getElementById("Ausw"+i).checked = true;
        }
    } else {
    for (let i = 0; i<KategorienArray.length; i++){
        document.getElementById("Ausw"+i).checked = false;
    }
}
}
function Speichern(){
    for (let i = 0; i<KategorienArray.length; i++){
        KategorienArray[i]=document.getElementById("Ausw"+i).checked;
    }

    if (KategorienArray.includes(true) == false){
        document.getElementById("Ausw0").checked = true;
    }
    for (let i = 0; i<KategorienArray.length; i++){
        KategorienArray[i]=document.getElementById("Ausw"+i).checked;
    }
    document.getElementById("checkbox_toggle").disabled = false;
    document.getElementById("checkbox_toggle").checked = false;
    AufgabenArrayFestleger();
    NeueAufgabeStarten();
}
function FarbEinsteller(){
    document.getElementById("Anz0").style.color = "black";
    document.getElementById("Anz1").style.color = "black";
    document.getElementById("Anz2").style.color = "black";
    document.getElementById("Anz3").style.color = "black";
    document.getElementById("Anz4").style.color = "black";
    document.getElementById("Anz0").style.borderColor = "black";
    document.getElementById("Anz1").style.borderColor = "black";
    document.getElementById("Anz2").style.borderColor = "black";
    document.getElementById("Anz3").style.borderColor = "black";
    document.getElementById("Anz4").style.borderColor = "black";
    document.getElementById("Anz4").style.backgroundColor = "";
    for (let i = 0 ; i < level ; i++){
        document.getElementById("Anz"+i).style.color = "green";
        document.getElementById("Anz"+i).style.borderColor = "green";
        document.getElementById("Anz"+i).style.backgroundColor = "";
    }
    for (let i = 4 ; i > level ; i--){
        document.getElementById("Anz"+i).style.color = "black";
        document.getElementById("Anz"+i).style.borderColor = "black";
        document.getElementById("Anz"+i).style.backgroundColor = "";
    }
    document.getElementById("Anz"+level).style.color = "white";
    document.getElementById("Anz"+level).style.borderColor = "green";
    document.getElementById("Anz"+level).style.backgroundColor = "green";
   
}


function KoeffizientenVerkleinern(richtigeId){
    let meineVariable = "";
    meineVariable = document.getElementById(richtigeId).value;
    meineVariable = meineVariable.replace("^1", "¹");
    meineVariable = meineVariable.replace("^2", "²");
    meineVariable = meineVariable.replace("^3", "³");
    meineVariable = meineVariable.replace("^4", "⁴");
    meineVariable = meineVariable.replace("^5", "⁵");
    meineVariable = meineVariable.replace("^6", "⁶");
    meineVariable = meineVariable.replace("^7", "⁷");
    meineVariable = meineVariable.replace("^8", "⁸");
    meineVariable = meineVariable.replace("^9", "⁹");
    meineVariable = meineVariable.replace("^0", "⁰");
    meineVariable = meineVariable.replace("1", "₁");
    meineVariable = meineVariable.replace("2", "₂");
    meineVariable = meineVariable.replace("3", "₃");
    meineVariable = meineVariable.replace("4", "₄");
    meineVariable = meineVariable.replace("5", "₅");
    meineVariable = meineVariable.replace("6", "₆");
    meineVariable = meineVariable.replace("7", "₇");
    meineVariable = meineVariable.replace("8", "₈");
    meineVariable = meineVariable.replace("9", "₉");
    meineVariable = meineVariable.replace("0", "₀");
    meineVariable = meineVariable.replace("+", "⁺");
    meineVariable = meineVariable.replace("-", "⁻");
    document.getElementById(richtigeId).value = meineVariable;
}


function KoeffizientenVerkleinernSummenformel(meineVariable){
    meineVariable = meineVariable.replace("^1", "¹");
    meineVariable = meineVariable.replace("^2", "²");
    meineVariable = meineVariable.replace("^3", "³");
    meineVariable = meineVariable.replace("^4", "⁴");
    meineVariable = meineVariable.replace("^5", "⁵");
    meineVariable = meineVariable.replace("^6", "⁶");
    meineVariable = meineVariable.replace("^7", "⁷");
    meineVariable = meineVariable.replace("^8", "⁸");
    meineVariable = meineVariable.replace("^9", "⁹");
    meineVariable = meineVariable.replace("^0", "⁰");
    meineVariable = meineVariable.replace("1", "₁");
    meineVariable = meineVariable.replace("2", "₂");
    meineVariable = meineVariable.replace("3", "₃");
    meineVariable = meineVariable.replace("4", "₄");
    meineVariable = meineVariable.replace("5", "₅");
    meineVariable = meineVariable.replace("6", "₆");
    meineVariable = meineVariable.replace("7", "₇");
    meineVariable = meineVariable.replace("8", "₈");
    meineVariable = meineVariable.replace("9", "₉");
    meineVariable = meineVariable.replace("0", "₀");
    meineVariable = meineVariable.replace("+", "⁺");
    meineVariable = meineVariable.replace("-", "⁻");
    return meineVariable;
}

function KoeffizientenVergrößern(meinText){
    let meineVariable = "";
    meineVariable = meinText;
    meineVariable = meineVariable.replaceAll("⁺","+");
    meineVariable = meineVariable.replaceAll("⁻","-");
    meineVariable = meineVariable.replaceAll("¹","^1");
    meineVariable = meineVariable.replaceAll("²","^2");
    meineVariable = meineVariable.replaceAll("³","^3");
    meineVariable = meineVariable.replaceAll("⁴","^4");
    meineVariable = meineVariable.replaceAll("⁵","^5");
    meineVariable = meineVariable.replaceAll("⁶","^6");
    meineVariable = meineVariable.replaceAll("⁷","^7");
    meineVariable = meineVariable.replaceAll("⁸","^8");
    meineVariable = meineVariable.replaceAll("⁹","^9");
    meineVariable = meineVariable.replaceAll("⁰","^0");
    meineVariable = meineVariable.replaceAll("₁", "1");
    meineVariable = meineVariable.replaceAll("₂", "2");
    meineVariable = meineVariable.replaceAll("₃", "3");
    meineVariable = meineVariable.replaceAll("₄", "4");
    meineVariable = meineVariable.replaceAll("₅", "5");
    meineVariable = meineVariable.replaceAll("₆", "6");
    meineVariable = meineVariable.replaceAll("₇", "7");
    meineVariable = meineVariable.replaceAll("₈", "8");
    meineVariable = meineVariable.replaceAll("₉", "9");
    meineVariable = meineVariable.replaceAll("₀", "0");
    meineVariable = KlammerVersteher(meineVariable);
    return meineVariable;
}

function Überprüfen(){
    
    if (level == 0) {
        var korrektE =1;
        var korrektP =1;
        var Arrayidentisch = true;
        for (let i=0; i < Reaktionsarray[0].length ; i++){
            var id = "";
            id = "E"+i;

            var Eigabe = KoeffizientenVergrößern(document.getElementById(id).value);
            if (Eigabe == "") { 
                korrektE = 0;
                document.getElementById(id).style.backgroundColor = "red";
            } else {
            document.getElementById(id).style.removeProperty("background-color");

            var ArrayA = SummenformelArray(Eigabe);
            var richtigeFormel = "";
            richtigeFormel = Reaktionsarray[0][i][0];
            


            if (KoeffizientenVergrößern(document.getElementById(id).value) != KoeffizientenVergrößern(richtigeFormel)) {
                Arrayidentisch = false;
                document.getElementById(id).style.backgroundColor = "coral";
            } else { document.getElementById(id).style.backgroundColor = "green";}
            var ArrayB = SummenformelArray(richtigeFormel);

            var test = SchonVorhanden(ArrayA,ArrayB);
            ArrayA=ZählArray(ArrayA,test);
            ArrayB=ZählArray(ArrayB,test);


            
            if (SummenGleich(ArrayA,ArrayB)!= true){
                korrektE *= 0;
                document.getElementById(id).style.backgroundColor = "red";
            } 


        }
        }
        
            

        for (let i=0; i < Reaktionsarray[1].length ; i++){
            var id = "";
            id = "P"+i;
            document.getElementById(id).style.removeProperty("background-color");
            var Eigabe = KoeffizientenVergrößern(document.getElementById(id).value);
            if (Eigabe == "") { 
                korrektP = 0;
                document.getElementById(id).style.backgroundColor = "red";
            } else {
            var ArrayA = SummenformelArray(Eigabe);
            var richtigeFormel = "";
            richtigeFormel = Reaktionsarray[1][i][0];
            if (KoeffizientenVergrößern(document.getElementById(id).value) != KoeffizientenVergrößern(richtigeFormel)) {
                Arrayidentisch = false;
                document.getElementById(id).style.backgroundColor = "coral";



            }else { document.getElementById(id).style.backgroundColor = "green";}
            var ArrayB = SummenformelArray(richtigeFormel);

            var test = SchonVorhanden(ArrayA,ArrayB);
            
            ArrayA=ZählArray(ArrayA,test);
            ArrayB=ZählArray(ArrayB,test);

            if (SummenGleich(ArrayA,ArrayB)!= true){
                korrektE *= 0;
                document.getElementById(id).style.backgroundColor = "red";
            } 


        }
    }
        
        if (korrektE*korrektP == 1) {
            document.getElementById("AntwortSatz").innerHTML = "Super, alles richtig";
            if (Arrayidentisch == false){
                document.getElementById("AntwortSatz").innerHTML += '<br> Aber für mindestens eine Summenformel verwenden wir eine andere Schreibweise.';
            }
            
            document.getElementById("AntwortSatz").innerHTML += '<br><br><input type="button" value="Weiter" onclick=Ausgleich()>';

        } else {
            document.getElementById("AntwortSatz").innerHTML = 'Leider falsch <br><br><input type="button" value="Hilfe anzeigen" onclick="HilfeAnzeigen0()">';
            failCounter += 1;
        }
        if (failCounter >= 3){
            document.getElementById("AntwortSatz").innerHTML += '&ensp; <input type="button" value="Lösung zeigen" onclick="Ausgleich()">';
        }
    } else if (level == 1){
        document.getElementById("Hilfestellung").innerHTML="Hinweis: Die Faktoren können als Dezimalzahlen (z.B. 0,5) oder als Brüche (z.B: 1/2) eingegeben werden. ";






        var EduktArray = [];
        for(let i=0; i<Reaktionsarray[0].length; i++){
            var id = "ZahlE"+i;
            if (document.getElementById(id).value == ""){
                    document.getElementById(id).value = 1;
                }
            var Faktor = document.getElementById(id).value;
            Faktor=Faktor.replace(/\,/, ".");            
            Faktor = eval(Faktor);
            var Formel = KoeffizientenVergrößern(Reaktionsarray[0][i][0]);
            let Ergebnis = [];
            Ergebnis = Formel.split(/(?=[A-Z])/);
            let teste;
            if (Formel.indexOf("^") != -1){    
                let Ladung = Formel.split("^");
                
                teste = Ladung[1].match(/[0-9]/g);
                if (teste == null){
                    teste = 1;
                }
                Ladung = Ladung[1].match(/[^0-9]/g);
                if (Ladung[0] == "-"){
                    teste = teste * (-1);
                }
                if (Ladung[0] == "+"){
                    teste = parseInt(teste);
                }
            
                } else if (Formel.includes("+") == true){
                    teste = 1;
                } else if (Formel.includes("-") == true){
                    teste = -1;
                } else { teste = 0;}
                EduktArray.push(["J",teste*Faktor]);
            
            
        for (let j=0;j<Ergebnis.length;j++){
            let Element = Ergebnis[j].match(/[a-z]+/gi);
            if (Element == null){
                break;
            } else {
            let Zahl;
            if (Ergebnis[j].match(/\d+/g) == null){
                Zahl = 1;
            } else {
                Zahl = Ergebnis[j].match(/\d+/g);
            }

            if (Element[0] != "e"){
                EduktArray.push([Element[0], parseInt(Zahl)*Faktor]);

            }
        }
            }
        }
        var ProduktArray = [];
        for(let i=0; i<Reaktionsarray[1].length; i++){
            
            
            var id = "ZahlP"+i;
            if (document.getElementById(id).value == ""){
                    document.getElementById(id).value = 1;
                }
            var Faktor = document.getElementById(id).value;
            Faktor=Faktor.replace(/\,/, ".");            
            Faktor = eval(Faktor);
            var Formel = KoeffizientenVergrößern(Reaktionsarray[1][i][0]);
            let Ergebnis = [];
            Ergebnis = Formel.split(/(?=[A-Z])/);
            let teste;
            if (Formel.indexOf("^") != -1){    
                let Ladung = Formel.split("^");
                
                teste = Ladung[1].match(/[0-9]/g);
                if (teste == null){
                    teste = 1;
                }
                Ladung = Ladung[1].match(/[^0-9]/g);
                if (Ladung[0] == "-"){
                    teste = teste * (-1);
                }
                if (Ladung[0] == "+"){
                    teste = parseInt(teste);
                }
            
                } else if (Formel.includes("+") == true){
                    teste = 1;
                } else if (Formel.includes("-") == true){
                    teste = -1;
                } else { teste = 0;}
                ProduktArray.push(["J",teste*Faktor]);
            
            
        for (let j=0;j<Ergebnis.length;j++){
            let Element = Ergebnis[j].match(/[a-z]+/gi);
            if (Element == null){
                break;
            } else {
            let Zahl;
            if (Ergebnis[j].match(/\d+/g) == null){
                Zahl = 1;
            } else {
                Zahl = Ergebnis[j].match(/\d+/g);
            }

            if (Element[0] != "e"){
                ProduktArray.push([Element[0], parseInt(Zahl)*Faktor]);
            }
        }
            }
        }


        SchonArray = [];
        SchonArray = SchonVorhanden(EduktArray,ProduktArray);
        ZählArrayE =[];
        ZählArrayP =[];
        ZählArrayE = ZählArray(EduktArray,SchonArray);


        ZählArrayP = ZählArray(ProduktArray,SchonArray);
        var summenGleichVar = SummenGleich(ZählArrayE,ZählArrayP);

        var FaktorNichtLeerVar = FaktorNichtLeer();
        if ((summenGleichVar == true) && (FaktorNichtLeerVar == true)){
            
            if (FaktorenNichtTeilerfremd() == true && FaktorNichtLeer() ==true){
                document.getElementById("AntwortSatz").innerHTML = "Super. Man hätte die Koeffizienten noch durch die gleiche Zahl teilen können.";
                let KlassenElemente = document.getElementsByClassName("small");
                for (let i=0; i< KlassenElemente.length; i++){
                    KlassenElemente[i].style.backgroundColor = "coral";
                }
            } else {
                document.getElementById("AntwortSatz").innerHTML = "Super, alles richtig";
                let KlassenElemente = document.getElementsByClassName("small");
                for (let i=0; i< KlassenElemente.length; i++){
                    KlassenElemente[i].style.backgroundColor = "green";
                }
            }

            document.getElementById("AntwortSatz").innerHTML += '<br><br><input type="button" value="Weiter" onclick=MolareMassen()>';

        } else {
            document.getElementById("AntwortSatz").innerHTML = 'Leider falsch <br><br><input type="button" value="Hilfe anzeigen" onclick="HilfeAusgleich()">';
            failCounter += 1;

            let KlassenElemente = document.getElementsByClassName("small");
                for (let i=0; i< KlassenElemente.length; i++){
                    KlassenElemente[i].style.backgroundColor = "red";
                }
        }
        
        

    } else if (level == 2) {
        var korrekt = true;
        for ( j = 0;  j < Reaktionsarray[0].length ; j++){

            var id = "MoMaE"+j;
            document.getElementById(id).style.removeProperty("background-color");
             if (document.getElementById(id).value.replace(/[a-zA-Z\/]/g, '') != molareMasseRechner(formelZerstückler(Reaktionsarray[0][j][0]))) {
                korrekt = false; 
                document.getElementById(id).style.backgroundColor = "red";

            } else { document.getElementById(id).style.backgroundColor = "green";
                document.getElementById(id).value = molareMasseRechner(formelZerstückler(Reaktionsarray[0][j][0]));
            }
        }
        for ( j = 0;  j < Reaktionsarray[1].length ; j++){
            var id = "MoMaP"+j;
            document.getElementById(id).style.removeProperty("background-color");

            if (document.getElementById(id).value.replace(/[a-zA-Z\/]/g, '') != molareMasseRechner(formelZerstückler(Reaktionsarray[1][j][0]))) {
                korrekt = false; 
                document.getElementById(id).style.backgroundColor = "red";

            } else { document.getElementById(id).style.backgroundColor = "green";
                document.getElementById(id).value = molareMasseRechner(formelZerstückler(Reaktionsarray[1][j][0]));
            }
        }
        
        if (korrekt == true) {
            document.getElementById("AntwortSatz").innerHTML = "Super, alles richtig";
            document.getElementById("AntwortSatz").innerHTML += '<br><br><input type="button" value="Weiter" onclick=StoffMBerechnen()>';

        } else {
            document.getElementById("AntwortSatz").innerHTML = 'Leider falsch <br><br><input type="button" value="Hilfe anzeigen" onclick="HilfeMolM()">';
            failCounter += 1;
        }
        if (failCounter >= 3){
            document.getElementById("AntwortSatz").innerHTML += '&ensp; <input type="button" value="Lösung zeigen" onclick="StoffMBerechnen()">';
        }
    } else if (level == 3){
        var korrekt = true;
        for ( j = 0;  j < Reaktionsarray[0].length ; j++){
            var id = "NE"+j;
            var Eingabe = "";
            Eingabe = document.getElementById(id).value;
            Eingabe = Eingabe.replace(/[a-zA-Z]/g, '');
            document.getElementById(id).style.removeProperty("background-color");
            Eingabe = Eingabe.replace(/\,/, ".");

            Eingabe = eval(Eingabe);
             if (Eingabe != Reaktionsarray[0][j][4]) {
                korrekt = false; 
                document.getElementById(id).style.backgroundColor = "red";

            }else { document.getElementById(id).style.backgroundColor = "green";
                let ausgeben = "";
                ausgeben = Reaktionsarray[0][j][4]+"";
                ausgeben = ausgeben.replace(/\./, ",");
                document.getElementById(id).value = ausgeben;
            }
        }
        for ( j = 0;  j < Reaktionsarray[1].length ; j++){
            var id = "NP"+j;
            document.getElementById(id).style.removeProperty("background-color");
            var Eingabe = "";
            Eingabe = document.getElementById(id).value;
            Eingabe = Eingabe.replace(/[a-zA-Z]/g, '');
            Eingabe = Eingabe.replace(/\,/, ".");
            Eingabe = eval(Eingabe);
            if (Eingabe != Reaktionsarray[1][j][4]) {
                korrekt = false; 
                document.getElementById(id).style.backgroundColor = "red";

            }else { document.getElementById(id).style.backgroundColor = "green";
                let ausgeben = "";
                ausgeben = Reaktionsarray[1][j][4]+"";
                ausgeben = ausgeben.replace(/\./, ",");
                document.getElementById(id).value = ausgeben;
            }
        }
        
        if (korrekt == true) {
            document.getElementById("AntwortSatz").innerHTML = "Super, alles richtig";
            document.getElementById("AntwortSatz").innerHTML += '<br><br><input type="button" value="Weiter" onclick=MasseBerechnen()>';

        } else {
            document.getElementById("AntwortSatz").innerHTML = 'Leider falsch <br><br><input type="button" value="Hilfe 1" onclick="HilfeStoffM1()"> &ensp; <input type="button" value="Hilfe 2" onclick="HilfeStoffM2()">';
            failCounter += 1;
        }
        if (failCounter >= 3){
            document.getElementById("AntwortSatz").innerHTML += '&ensp; <input type="button" value="Lösung zeigen" onclick="MasseBerechnen()">';
        }
    }else if (level == 4){
        var korrekt = true;
        for ( j = 1;  j < Reaktionsarray[0].length ; j++){
            var id = "mE"+j;
            document.getElementById(id).style.removeProperty("background-color");
            var Eingabe = "";
            Eingabe = document.getElementById(id).value;
            Eingabe.replace(/[a-zA-Z]/g, '');
            Eingabe = Eingabe.replace(/\,/, ".");
            Eingabe = eval(Eingabe);
             if (Eingabe != Reaktionsarray[0][j][5]) {
                korrekt = false; 
                document.getElementById(id).style.backgroundColor = "red";

            }else { document.getElementById(id).style.backgroundColor = "green";
                let ausgeben = "";
                ausgeben = Reaktionsarray[0][j][5]+"";
                ausgeben = ausgeben.replace(/\./, ",");
                document.getElementById(id).value = ausgeben;
            }
        }
        for ( j = 0;  j < Reaktionsarray[1].length ; j++){
            var id = "mP"+j;
            var Eingabe = "";
            Eingabe = document.getElementById(id).value;
            Eingabe.replace(/[a-zA-Z]/g, '');
            document.getElementById(id).style.removeProperty("background-color");

            Eingabe = Eingabe.replace(/\,/, ".");
            Eingabe = eval(Eingabe);
            
            if (Eingabe != Reaktionsarray[1][j][5]) {
                korrekt = false; 
                document.getElementById(id).style.backgroundColor = "red";

            }else { document.getElementById(id).style.backgroundColor = "green";
                let ausgeben = "";
                ausgeben = Reaktionsarray[1][j][5]+"";
                ausgeben = ausgeben.replace(/\./, ",");
                document.getElementById(id).value = ausgeben; 
            }
        }
        
        if (korrekt == true) {
            document.getElementById("AntwortSatz").innerHTML = "Super, alles richtig. Du bist fertig!";
            document.getElementById("AntwortSatz").innerHTML += '<br><br><input type="button" value="Neue Aufgabe starten" onclick=NeueAufgabeStarten() >';

        } else {
            document.getElementById("AntwortSatz").innerHTML = 'Leider falsch <br><br><input type="button" value="Hilfe anzeigen" onclick="HilfeMasse()">';
            failCounter += 1;
        }
        if (failCounter >= 3){
            document.getElementById("AntwortSatz").innerHTML += '&ensp; <input type="button" value="Lösung zeigen" onclick="LösungStufe5()">';
        }
    }
   // LebensAnzeiger();
}


function LösungStufe5(){
        for (let j = 1;  j < Reaktionsarray[0].length ; j++){
            var id = "mE"+j;
            document.getElementById(id).style.removeProperty("background-color");
            var Eingabe ="";
            Eingabe += Reaktionsarray[0][j][5];
            Eingabe = Eingabe.replace(/\./, ",");
            document.getElementById(id).value = Eingabe;
                
        }
        for (let j = 0;  j < Reaktionsarray[1].length ; j++){
            var id = "mP"+j;
            document.getElementById(id).style.removeProperty("background-color");
            var Eingabe ="";
            Eingabe += Reaktionsarray[1][j][5];
            Eingabe = Eingabe.replace(/\./, ",");
            document.getElementById(id).value = Eingabe;
                
        }
    }

    function FaktorNichtLeer(){
        var faktorNichtLeerVariable = true;
        for(i=0; i<Reaktionsarray[0].length; i++){
                var id = "ZahlE"+i;
                var Faktor = document.getElementById(id).value;
                Faktor=Faktor.replace(/\,/, ".");
                Faktor = eval(Faktor);
                if (Faktor <= 0 || Faktor == null){
                    faktorNichtLeerVariable = false;
                }
            }
            return faktorNichtLeerVariable


    }

    function bilderEinfüger(SchonArray){
            
            for (i=0; i<SchonArray.length;i++){  
                    if (SchonArray[i]!="J"){          
                    let img = new Image();
                    img.className ="image";
                    img.src = "img/PSE-"+SchonArray[i]+".jpg";
                    img.width = 200;
                    document.getElementById('Bilder').appendChild(img);
                    }
                }
            }
        


        function SummenformelArray(summenFormel){
            
            const Formel = summenFormel;
            let Ladung = Formel.split("^");
            let teste = Ladung[1].match(/[0-9]/g);
            if (teste == null){
                teste = 1;
            }
            Ladung = Ladung[1].match(/[^0-9]/g);
            if (Ladung[0] == "-"){
                teste = teste * (-1);
            }
            if (Ladung[0] == "+"){
                teste = parseInt(teste);
            }
            const Ergebnis = Formel.split(/(?=[A-Z])/);
            var summenArray = [];
            for (i=0;i<Ergebnis.length;i++){
                let Element = Ergebnis[i].match(/[a-z]+/gi);
                let Zahl;
                if (Ergebnis[i].match(/\d+/g) == null){
                    Zahl = [1,0];
                } else {
                    Zahl = Ergebnis[i].match(/\d+/g);
                }
                summenArray[i] = [Element[0], parseInt(Zahl[0])];
            }
            summenArray.push(["J",teste]);
            return summenArray;
        }

        function formelZerstückler(summenFormel){
            var summenArray = SummenformelArray(summenFormel);
            
            
            const neuesArray = [];
            for (i=0;i<meinArray.length;i++){
                neuesArray[i] = meinArray[i][1];
            }
            for (i=0; i<summenArray.length;i++){
                summenArray[i].push(neuesArray.indexOf(summenArray[i][0]));
                summenArray[i].push(meinArray[summenArray[i][2]][2]);
                summenArray[i].push(meinArray[summenArray[i][2]][3]);
            }
            return (summenArray);
            
        }




        function molareMasseRechner(summenArray){
            var molareMasse = 0;
            for (i=0; i<summenArray.length;i++){
                molareMasse += summenArray[i][1]*summenArray[i][3];
            }
            return molareMasse;
        }

function FaktorenNichtTeilerfremd(){
    ggT = document.getElementById("ZahlE0").value;
    for(i=0; i<Reaktionsarray[0].length; i++){
                var id = "ZahlE"+i;
                var Faktor = document.getElementById(id).value;
                Faktor=Faktor.replace(/\,/, ".");
                Faktor = eval(Faktor);
                ggT = EA(ggT,Faktor);
    }
    for(i=0; i<Reaktionsarray[1].length; i++){
                var id = "ZahlP"+i;
                var Faktor = document.getElementById(id).value;
                Faktor=Faktor.replace(/\,/, ".");
                Faktor = eval(Faktor);
                ggT = EA(ggT,Faktor);
                
    }
  


                
    

    if (ggT == 1) {
        return false;
    } else {
        return true;
    }
}

function FaktorenEintrager(){
    ggT = document.getElementById("ZahlE0").value;
    for(i=0; i<Reaktionsarray[0].length; i++){
                var id = "ZahlE"+i;
                var Faktor = document.getElementById(id).value;
                Faktor=Faktor.replace(/\,/, ".");
                Faktor = eval(Faktor);
                ggT = EA(ggT,Faktor);
    }
    for(i=0; i<Reaktionsarray[1].length; i++){
                var id = "ZahlP"+i;
                var Faktor = document.getElementById(id).value;
                Faktor=Faktor.replace(/\,/, ".");
                Faktor = eval(Faktor);
                ggT = EA(ggT,Faktor);
                
    }
  

    for(i=0; i<Reaktionsarray[0].length; i++){
                var id = "ZahlE"+i;
                var Faktor = document.getElementById(id).value;
                Faktor=Faktor.replace(/\,/, ".");
                Faktor = eval(Faktor);
                Reaktionsarray[0][i].push(Faktor/ggT);
    }
    for(i=0; i<Reaktionsarray[1].length; i++){
                var id = "ZahlP"+i;
                var Faktor = document.getElementById(id).value;
                Faktor=Faktor.replace(/\,/, ".");
                Faktor = eval(Faktor);
                ggT = EA(ggT,Faktor);
                Reaktionsarray[1][i].push(Faktor/ggT);
                
    }


}


function EA(a,b){
    while(b != 0){
        let ganzZ = a/b;
        let Rest = a % b;
        a=b;
        b= Rest;
        
    }
    return(a);
}
    
function SummenGleich(ZählArrayE,ZählArrayP){
    var korrekt = true;
    for (i=0; i< ZählArrayE.length; i++){
        if (ZählArrayE[i] != ZählArrayP[i]){
            korrekt = false;
        }
    }
    return korrekt;
}



function SchöneSummenformel(SummenformelText){
        if (SummenformelText.indexOf("(") == -1) {
            var summenArray = SummenformelArray(SummenformelText);
            var ausgabeAlsText = "";
            for (let i=0;i<summenArray.length;i++){
                if (summenArray[i][0] != "J"){
                    if (Math.abs(summenArray[i][1]) != 1){
                        ausgabeAlsText += summenArray[i][0]+"<sub>"+summenArray[i][1]+"</sub>"; 
                    } else {
                        ausgabeAlsText += summenArray[i][0]; 
                    }
                }
            }
            for (let i=0;i<summenArray.length;i++){
                if (summenArray[i][0] == "J"){
                    if ((Math.abs(summenArray[i][1]) != 1) && (summenArray[i][1] != 0) ){
                        ausgabeAlsText += "<sup>"+Math.abs(summenArray[i][1])+"</sup>";
                    } else if ((Math.abs(summenArray[i][1]) == 1) && (summenArray.length == 1)){
                        ausgabeAlsText += "e";
                    }
                    if (summenArray[i][1] > 0){
                        ausgabeAlsText += "<sup>"+"+"+"</sup>"
                    } else if (summenArray[i][1] < 0) {
                        ausgabeAlsText += "<sup>"+"-"+"</sup>"
                    } 
                    
                }
            }
            return ausgabeAlsText;
        } else {
            return KoeffizientenVerkleinernSummenformel(SummenformelText);
        }
        }


function HilfeAnzeigen0(){
    document.getElementById("Hilfestellung").innerHTML="";

    let hilfeTextGase = "";
    let gibtEsGase = false;
    let schwefelDrin = false;
    let einAtomig = false;
    let Beispiel=[];
    let einAtomigBsp = [];
    let organisch = false;
    let organischBsp = [];
    for (let j = 0;  j < Reaktionsarray[0].length ; j++){
        let meinArray = SummenformelArray(Reaktionsarray[0][j][0]);
        meinArray.pop();
        if (meinArray[0].includes("S")) {
            schwefelDrin = true;
        }
        if ((meinArray.length == 1) && (meinArray[0][1] == 1)){
            einAtomig = true;
            einAtomigBsp.push([Reaktionsarray[0][j][0],Reaktionsarray[0][j][1]]);
        }
        if ((meinArray.length == 1) && (meinArray[0][1] == 2)){
            gibtEsGase = true;
            Beispiel.push([Reaktionsarray[0][j][0],Reaktionsarray[0][j][1]]);
        }
        if(meinArray.length>1){
            if (meinArray[1].includes("H") && meinArray[0].includes("C") ) {
                organisch = true;
                organischBsp.push([Reaktionsarray[0][j][0],Reaktionsarray[0][j][1]]);
            }
        }
    }
    for (let j = 0;  j < Reaktionsarray[1].length ; j++){
        let meinArray = SummenformelArray(Reaktionsarray[1][j][0])

        
        meinArray.pop();

        if (meinArray[0].includes("S")) {
            schwefelDrin = true;
        }
        if ((meinArray.length == 1) && (meinArray[0][1] == 1)){
            einAtomig = true;
            einAtomigBsp.push([Reaktionsarray[1][j][0],Reaktionsarray[1][j][1]]);
        }
        if ((meinArray.length == 1) && (meinArray[0][1] == 2)){
            gibtEsGase = true;
            Beispiel.push([Reaktionsarray[1][j][0],Reaktionsarray[1][j][1]]);
        }
        if(meinArray.length>1){
            if (meinArray[1].includes("H") && meinArray[0].includes("C") ) {
                organisch = true;
                organischBsp.push([Reaktionsarray[1][j][0],Reaktionsarray[1][j][1]]);
            }
        }
    }
    if (gibtEsGase == true){
        hilfeTextGase="Elementare Gase (außer die Edelgase in der 8. Hauptgruppe) kommen oft zweiatomig vor. <br> Z.B. "+Beispiel[0][1]+"  "+SchöneSummenformel(Beispiel[0][0]);
        for (let i=1; i<Beispiel.length;i++){
            hilfeTextGase += "<br> und "+Beispiel[i][1]+"  "+SchöneSummenformel(Beispiel[i][0]);
        }
        document.getElementById("Hilfestellung").innerHTML = hilfeTextGase;
    }
    if (schwefelDrin == true) {
        document.getElementById("Hilfestellung").innerHTML += "Schwefel kommt als 8-atomiges Molekül vor, also mit der Summenformel S<sub>8</sub>.";
        }
    if (einAtomig == true){
        hilfeTextGase="<br> <br>Viele elementare Stoffe, z.B. alle Metalle, sind einatomig aufgebaut:<br> Z.B. "+einAtomigBsp[0][1]+"  "+SchöneSummenformel(einAtomigBsp[0][0]);
        for (let i=1; i<einAtomigBsp.length;i++){
            hilfeTextGase += "<br> und "+einAtomigBsp[i][1]+"  "+SchöneSummenformel(einAtomigBsp[i][0]);
        }
        document.getElementById("Hilfestellung").innerHTML += hilfeTextGase;
    }    
    if (organisch == true){
        hilfeTextGase="<br> <br>Moleküle der organischen Chemie sind v.a. aus Kohlenstoffatomen und Wasserstoffatomen aufgebaut.<br> Am Namen erkennt man die Anzahl der C-Atome Z.B. "+organischBsp[0][1]+" besitzt "+SummenformelArray(organischBsp[0][0])[0][1]+" C-Atome.";
        for (let i=1; i<einAtomigBsp.length;i++){
            hilfeTextGase += "<br> und "+einAtomigBsp[i][1]+"  "+SchöneSummenformel(einAtomigBsp[i][0])+". <br><br>";
        }
        document.getElementById("Hilfestellung").innerHTML += hilfeTextGase;
    }   
    if (document.getElementById("Hilfestellung").innerHTML != "") {
        document.getElementById("Hilfestellung").innerHTML += "<br><br>Weiter allgemeine Informationen findest du hier: ";
    } else { document.getElementById("Hilfestellung").innerHTML += "Allgemeine Informationen findest du hier:";}
    document.getElementById("Hilfestellung").innerHTML += "<br>";
   // document.getElementById("Hilfestellung").innerHTML += '<br> <input type="button" id="Input1" class="Infos" value="Organische Chemie" onclick="TextAnzeigen(1)">';
    document.getElementById("Hilfestellung").innerHTML += '&ensp; <input type="button" id="Input2" class="Infos" value="molekulare Stoffe" onclick="TextAnzeigen(2)">';
    document.getElementById("Hilfestellung").innerHTML += '&ensp; <input type="button" id="Input3" class="Infos" value="Salze" onclick="TextAnzeigen(3)">';
    document.getElementById("Hilfestellung").innerHTML += '<br> <p id="allgemeineHilfe"></p>';
}

function TextAnzeigen(wert){
    var text = [];
    text.push("");
    let OCText = "";
    OCText = "In der organischen Chemie gibt uns der Name auskunft über die Anzahl der Kohlenstoffatome. Wir betrachten zunächst die Alkane."
    OCText += "<br><img src='img/OC.jpg' width='70%'>";
    OCText += "<br>Für weiter Stoffgruppen gilt folgendes:";
    OCText += `<table style="display:flex; justify-content:space-around;" class="OC"'>
    <tr>
        <td>Stoffgruppe</td>
        <td>Endung</td>
        <td>Unterschied der Summenformel zu der von Alkanen</td>
    </tr>
    <tr>
        <td>Alkene</td>
        <td>"en" statt "an"</td>
        <td>Pro Doppelbindung zwei Wasserstoffatome weniger.</td>
    </tr>
    <tr>
        <td>Alkine</td>
        <td>"in" statt "an"</td>
        <td>Pro Dreifachbindung vier Wasserstoffatome weniger.</td>
    </tr>
    <tr>
        <td>Alkanole/Alkohole</td>
        <td>"-ol"</td>
        <td>Ein Sauerstoffatom mehr in der Summenformel bei einfachen Alkanolen.</td>
    </tr>
    <tr>
        <td>Alkanale/Aldehyde</td>
        <td>"-al"</td>
        <td>Ein Sauerstoffatom mehr und zwei Wasserstoffatome weniger.</td>
    </tr>
    <tr>
        <td>Alkanone/Ketone</td>
        <td>"-on"</td>
        <td>Ein Sauerstoffatom mehr und zwei Wasserstoffatome weniger.</td>
    </tr>
    <tr>
        <td>Alkansäuren/Carbonsäuren</td>
        <td>"-säure"</td>
        <td>Zwei Sauerstoffatome mehr und zwei Wasserstoffatome weniger.</td>
    </tr>
</table>`

    text.push(OCText);
    text.push("Summenformeln von Nichtmetall-Nichtmetallverbindungen kann man mithilfe des Names bestimmen. <br> z.B. steht \"-oxid\" für eine Verbindung mit Sauerstoff.<br> Vorsilben helfen bei der Einordnung der Oxide. So besitzt <span  style='color:red'>Mono</span>xid <span style='color:red'>ein</span> Sauerstoffatom,  <span style='color:blue'>Di</span>oxid <span style='color:blue'>zwei</span>.<br> z.B. bei Kohlenstoffmonoxid  CO   &ensp; und Kohlenstoffdioxid CO<sub>2</sub>");
    text.push("Salze, also Verbindungen aus Metallen und Nichtmetallen, können auf verschiedene Weisen erklärt werden.<br> Entweder mit dem Konzept der <input type='button' id='SalzInfo1' value='Wertigkeit' class='Infos' onclick='Salzinfos(1)'> oder durch die <input id='SalzInfo2' type='button' class='Infos' value='Ionenladung' onclick='Salzinfos(2)'>.<br><p id='SalzinfoText'></p>");





        if (textbool != wert){
            textbool = wert;
            } else {
                textbool = 0;
            }   

            for (let i=2; i<=3; i++){
            let id="";
            id = "Input"+i;
            if (i == textbool){
                document.getElementById(id).style.backgroundColor = "green";
            }else {
                document.getElementById(id).style.backgroundColor = "burlywood";
            }
        }
        let AusgabeText = "";
        AusgabeText = text[textbool];
        salzErklärung = 0;
        document.getElementById("allgemeineHilfe").innerHTML = AusgabeText;
    }


function Salzinfos(wert){
    var ErklärtextSalze = [];
    ErklärtextSalze.push("");
    let WertigkeitsErklärung = "a";
    WertigkeitsErklärung = `
    <p>
    <h2>Die Wertigkeit</h2>
    Die Wertigkeit ist eine vereinfachte Erklärung für Verbindungen, die aus zwei Elementen bestehen. <br>
    Sie gibt für jedes Element an, wie viele Wasserstoffatome man an ein Atom dieses Elements binden oder in einer Verbindung ersetzen kann. <br>
    Die Wertigkeiten hängen stark mit der Hauptgruppe im Periodensystem zusammen. Du findest die Wertigkeiten unten in der Tabelle: <br>
    <img src="img/WertigkeitsBild.jpg" class="center" width="80%"> <br>
    Die Wertigkeiten von Übergangsmetallen (z.B. Kuper) sind nicht immer eindeutig. Deshalb müssen sie im Namen angegeben werden (z.B. Kupfer(II)oxid).
    <br> 
    <h2>Bestimmen der Summenformel an einem Beispiel</h2> <br>
    Wir können jetzt bestimmen, wie viele "Wasserstoffe" etwas Wert ist. <br>
    In einer Verbindung müssen die einzelnen Elemente jeweils so oft vorkommen, dass sie gleich viel Wert sind. z.B. Mg (Wertigkeit II) und Cl (Wertigkeit I).<br>
    Damit beide gleich viel Wert sind, benötigen wir doppelt so viele Cl-Atome. Die Summenformel lautet dann MgCl<sub>2</sub><div class=""></div> <br>
    <img src="img/MgCl2.png" height="300px" class="center"> <br>
    Bei Aluminiumoxid sieht es folgendermaßen aus: Al (Wertigkeit III), O (Wertigkeit II). <br>
    Die kleinste Anzahl, bei der beide gleich viel Wert sind, ist hier bei zwei Aluminiumatomen und drei Sauerstoffatomen, also Al<sub>2</sub>O<sub>3</sub>. <br>
    <img src="img/Al2O3.png" height="240px" class="center"> 
</p>

    `



    let IonenladungsErklärung = "";
    IonenladungsErklärung = `
    <p>
    <h2>Die Ionenladung</h2>
    Salze setzen sich aus verschiedenen Ionen zusammen, den <span style="color: rgb(42, 156, 7)">Kationen</span>  (positiv geladen) und den <span style="color: fuchsia">Anionen</span> (negativ geladen.) <br>
    <img src="img/PSEIonen.png" height="600px" class="center"> 
    Metallatome der Hauptgruppen geben ihre Außenelektronen ab, um Edelgaskonfiguration zu erreichen. Sie bilden <span style="color: rgb(42, 156, 7)">Kationen</span>. <br>
    Sie geben entsprechend ihrer Hauptgruppennummer Elektronen ab. Somit wird z.B. Aluminium (Al) aus der dritten Hauptgruppe zum <span style="color:rgb(42, 156, 7) ">Aluminiumion (Al<sup>3+</sup>)</span>. <br>
    <br>
    Die Nichtmetallatome nehmen so viele Elektronen auf, bis sie die Anzahl an Außenelektronen der Edelgase erreicht haben und werden so <span style="color: fuchsia">negativ geladen</span>. <br>
    Für die Hauptgruppenatome der Nichtmetalle gilt hier, es werden acht minus die Hauptgruppennummer Elektronen aufgenommen. <br>
    So wird z.B. aus dem Sauerstoffatom (O) in der sechsten Hauptgruppe das <span style="color: fuchsia">Oxidion (O<sup>2-</sup>)</span>.
    <br> <br>
    Die Ionen lagern sich nun in möglichst kleinzahligen Verhältnissen so zusammen, dass die Ladung nach außen null ergibt. <br>
    Z.B. beim <span style="color:rgb(42, 156, 7) ">Aluminiumion (Al<sup>3+</sup>)</span> und dem <span style="color: fuchsia">Oxidion (O<sup>2-</sup>)</span>:  Al<sub>2</sub>O<sub>3</sub>, weil wir dann sechs positive Ladungen und sechs negative Ladungen haben.

    
</p>
    `



    ErklärtextSalze.push(WertigkeitsErklärung);
    ErklärtextSalze.push(IonenladungsErklärung);
    if (salzErklärung != wert){
        salzErklärung = wert;
            } else {
                salzErklärung = 0;
            }   
        for (let i=1; i<=2; i++){
            let id="";
            id = "SalzInfo"+i;
            if (i == salzErklärung){
                document.getElementById(id).style.backgroundColor = "green";
            }else {
                document.getElementById(id).style.backgroundColor = "burlywood";
            }
        }
        let AusgabeText = "";
        AusgabeText = ErklärtextSalze[salzErklärung];
        document.getElementById("SalzinfoText").innerHTML = AusgabeText;

}   
       
function HilfeAusgleich(){
    document.getElementById("Hilfestellung").innerHTML="";
    var AusgabeDerSummenformeln = "";
    let esGibtLadungen = false;
    for (let i = 0; i<Reaktionsarray[0].length; i++){
        if ((Reaktionsarray[0][i][0].includes("+") == true ) || (Reaktionsarray[0][i][0].includes("-") == true) ){
            esGibtLadungen = true;
        }
    }
    for (let i = 0; i<Reaktionsarray[1].length; i++){
        if ((Reaktionsarray[1][i][0].includes("+") == true ) || (Reaktionsarray[1][i][0].includes("-") == true) ){
            esGibtLadungen = true;
        }
    }


    if (ZählArrayP.includes(NaN) || ZählArrayE.includes(NaN) ){
        AusgabeDerSummenformeln = "Achtung, du scheinst nicht alle Faktoren eingetragen zu haben."
    } else {
        AusgabeDerSummenformeln = "Die Anzahlen der Atome auf beiden Seiten scheint nicht gleich zu sein. <br> Hier eine aktuelle Übersicht deiner Lösung.";
        AusgabeDerSummenformeln += "<table class='ElementTabelle'>";
        AusgabeDerSummenformeln += "<tr> <td>Element</td><td>Eduktsumme</td><td>Produktsumme</td> </tr>";
        for (i=0;i<SchonArray.length;i++){
            if (esGibtLadungen == true){
                if (SchonArray[i] != "J") {
                    AusgabeDerSummenformeln += "<tr> <td>"+SchonArray[i]+"</td><td>"+ZählArrayE[i]+"</td><td>"+ZählArrayP[i]+"</td> </tr>"
                } else if (SchonArray[i] == "J"){
                    AusgabeDerSummenformeln += "<tr> <td>elektrische Ladung</td><td>"+ZählArrayE[i]+"</td><td>"+ZählArrayP[i]+"</td> </tr>"
                }
            } else {
                if (SchonArray[i] != "J") {
                    AusgabeDerSummenformeln += "<tr> <td>"+SchonArray[i]+"</td><td>"+ZählArrayE[i]+"</td><td>"+ZählArrayP[i]+"</td> </tr>"
                }
            }
        }
        AusgabeDerSummenformeln += "</table>"
    }

    AusgabeDerSummenformeln += "<br><br> Probiere es nochmal und klicke dann auf Überprüfen";
    document.getElementById("Hilfestellung").innerHTML=AusgabeDerSummenformeln;
}

function HilfeMolM(){
    document.getElementById("Hilfestellung").innerHTML="";
    var AusgabeText = "";
    let ElektronenHinweis = false;

        AusgabeText = "Die molare Masse berechnest Du folgendermaßen: <br><br> M(";
        AusgabeText += SchöneSummenformel(Reaktionsarray[0][0][0])+") = ";
        summenArray = formelZerstückler(Reaktionsarray[0][0][0]);
        
        for (i=0; i<summenArray.length-1;i++){
            AusgabeText += summenArray[i][1]+" &#8901; M("+summenArray[i][0]+") +";
            }
            AusgabeText = AusgabeText.substring(0, AusgabeText.length-1)+" = ";
  
        for (i=0; i<summenArray.length-1;i++){
            AusgabeText += summenArray[i][1]+" &#8901; "+summenArray[i][3]+" <math><mfrac><mn>g</mn><mn>mol</mn></mfrac></math> +";
            } 
            AusgabeText = AusgabeText.substring(0, AusgabeText.length-1)

            AusgabeText += "= "+Reaktionsarray[0][0][3]+" <math><mfrac><mn>g</mn><mn>mol</mn></mfrac></math>";
    for (let i = 0; i<Reaktionsarray[0].length; i++){
        if (Reaktionsarray[0][i][0] == "e-"){
            ElektronenHinweis = true;
        }
    }
    for (let i = 0; i<Reaktionsarray[1].length; i++){
        if (Reaktionsarray[1][i][0] == "e-"){
            ElektronenHinweis = true;
        }
    }
    if (ElektronenHinweis == true){
        AusgabeText += "<br><br> Elektronen (e<sup>-</sup>) besitzen eine molare Masse von 0 <math><mfrac><mn>g</mn><mn>mol</mn></mfrac></math>.";
    }
                
    
        
    AusgabeText += "<br><br> Probiere es nochmal und klicke dann auf Überprüfen";

    document.getElementById("Hilfestellung").innerHTML=AusgabeText;
}

function HilfeStoffM1(){
    document.getElementById("Hilfestellung").innerHTML="";
    var AusgabeText = "";


        AusgabeText = "Die Stoffmenge des ersten Stoffes berechnest Du folgendermaßen: <br><br> n(";
        AusgabeText += SchöneSummenformel(Reaktionsarray[0][0][0])+") = <math><mfrac><mn><span>m("+SchöneSummenformel(Reaktionsarray[0][0][0])+")</span></mn><mn><span>M("+SchöneSummenformel(Reaktionsarray[0][0][0])+")</span></mn></mfrac></math>";
    

        AusgabeText += " = <math><mfrac><mn>"+AusgabeMitKomma(Stoffmenge * Reaktionsarray[0][0][3]) +"g</mn><mrow><mo>"+ Reaktionsarray[0][0][3]+"</mo><mfrac><mn>g</mn><mn>mol</mn></mfrac> </math> = ";

        AusgabeText += AusgabeMitKomma(Stoffmenge) +"   mol";
        
    AusgabeText += "<br><br> Probiere es nochmal und klicke dann auf Überprüfen";
    document.getElementById("Hilfestellung").innerHTML=AusgabeText;
}

function AusgabeMitKomma(TextMitPunkt){
    var OhneKomma = "";
    OhneKomma += TextMitPunkt;
    OhneKomma = OhneKomma.replace(/\./, ",");
    return OhneKomma;
}

function HilfeStoffM2(){
    document.getElementById("Hilfestellung").innerHTML="";
    var AusgabeText = "";

        document.getElementById("SpanP0").style.color = "blue";
        document.getElementById("SpanE0").style.color = "#db9e02";
        document.getElementById("SpanNP0").style.color = "blue";
        document.getElementById("SpanNE0").style.color = "#db9e02";
        document.getElementById("SpanP0").style.fontWeight = "bold";
        document.getElementById("SpanE0").style.fontWeight = "bold";
        document.getElementById("SpanNP0").style.fontWeight = "bold";
        document.getElementById("SpanNE0").style.fontWeight = "bold";

       // <math><mfrac><mn>g</mn><mn>mol</mn></mfrac>
        AusgabeText +="<h2>Berechnung mittels Soffmengenverhältnis </h2>";
        AusgabeText += "Mit der berechneten Stoffmenge berechnest Du die weiteren Stoffmengen so: <br><br> Wir betrachten dafür die Stoffmengenverhältnisse z.B. <br> ";
        AusgabeText += "<math><mfrac><mn><span style='color: blue; font-weight:bold;'> n("+ SchöneSummenformel(Reaktionsarray[1][0][0])+")</span></mn><mn><span style='color: #db9e02; font-weight:bold;'> n("+SchöneSummenformel(Reaktionsarray[0][0][0])+")</span></mn></mfrac></math> = <math><mfrac><mn><span style='color: blue; font-weight:bold;'>Vorfaktor("+ SchöneSummenformel(Reaktionsarray[1][0][0])+") </span></mn><mn><span style='color: #db9e02; font-weight:bold;'>Vorfaktor("+SchöneSummenformel(Reaktionsarray[0][0][0])+") </span></mn></mfrac></math> = <math><mfrac><mn><span style='color: blue; font-weight:bold;'>"+AusgabeMitKomma(Reaktionsarray[1][0][2])+"</span></mn><mn><span style='color: #db9e02; font-weight:bold;'>"+AusgabeMitKomma(Reaktionsarray[0][0][2])+"</span></mn></mfrac></math> = <span style='color: fuchsia; font-weight:bold;'>"+AusgabeMitKomma(Reaktionsarray[1][0][2]/Reaktionsarray[0][0][2])+"</span>";
        AusgabeText += "<br><br> Nach Multiplikation der Gleichung gilt <br><span style='color: blue; font-weight:bold;'> n("+ SchöneSummenformel(Reaktionsarray[1][0][0])+") </span> = <span style='color: fuchsia; font-weight:bold;'> "+AusgabeMitKomma((Reaktionsarray[1][0][2]/Reaktionsarray[0][0][2]))+"</span> &#8901;"+"<span style='color: #db9e02; font-weight:bold;'>n("+SchöneSummenformel(Reaktionsarray[0][0][0])+") </span> =  <span style='color: fuchsia; font-weight:bold;'>"+AusgabeMitKomma((Reaktionsarray[1][0][2]/Reaktionsarray[0][0][2]))+"</span> &#8901; <span style='color: #db9e02; font-weight:bold;'>"+AusgabeMitKomma(Reaktionsarray[0][0][4])+" </span> mol = "+AusgabeMitKomma(Reaktionsarray[1][0][4])+" mol";
        

    AusgabeText +="<h2>Alternative Erklärung mithilfe eines proportionalen Zusammenhangs </h2>";
    AusgabeText +="Wir notieren die Vorfaktoren und die gegebene Stoffmenge in einer Tabelle";
    AusgabeText +=  "<table border='1' style='width:30%' align='center'>";
        for (let i=0;i<Reaktionsarray[0].length;i++){
            AusgabeText +=`<th style='color: grey;'>`+SchöneSummenformel(Reaktionsarray[0][i][0])+`</th>`;
        }
        for (let i=0;i<Reaktionsarray[1].length;i++){
            AusgabeText +=`<th style='color: grey;'>`+SchöneSummenformel(Reaktionsarray[1][i][0])+`</th>`;
        }
        AusgabeText +=`</tr><tr>`;
            AusgabeText +=`<th><span style='color: #db9e02; font-weight:bold;'>`+Reaktionsarray[0][0][2]+`</span></th>`
        for (let i=1;i<Reaktionsarray[0].length;i++){
            AusgabeText +=`<th>`+Reaktionsarray[0][i][2]+`</th>`;
        }
        AusgabeText +=`<th><span style='color: blue; font-weight:bold;'>`+Reaktionsarray[1][0][2]+`</span></th>`;
        for (let i=1;i<Reaktionsarray[1].length;i++){
            AusgabeText +=`<th>`+Reaktionsarray[1][i][2]+`</th>`;
        }                    
        AusgabeText +=`</tr><tr>`;
        AusgabeText +=`<th>`+AusgabeMitKomma(Reaktionsarray[0][0][4])+` mol</th>`;
        for (let i=1;i<Reaktionsarray[0].length;i++){
            AusgabeText +=`<th>&emsp; mol</th>`;
        }
        AusgabeText +=`<th>`+AusgabeMitKomma(Reaktionsarray[1][0][4])+` mol</th>`;
        for (let i=1;i<Reaktionsarray[1].length;i++){
            AusgabeText +=`<th>&emsp; mol</th>`;
        }                    
        AusgabeText +=`</tr></table>`;                    

                   
    
    
 



    AusgabeText += "<br><br> Probiere es nochmal und klicke dann auf Überprüfen";
    document.getElementById("Hilfestellung").innerHTML=AusgabeText;
}

function HilfeMasse(){
    document.getElementById("Hilfestellung").innerHTML="";
    var AusgabeText = "";


        AusgabeText = "Die Masse des ersten Stoffes berechnest Du folgendermaßen: <br><br> m(";
        AusgabeText += SchöneSummenformel(Reaktionsarray[0][0][0])+") = n("+SchöneSummenformel(Reaktionsarray[0][0][0])+") &#8901; M("+SchöneSummenformel(Reaktionsarray[0][0][0])+")  ";

        AusgabeText += "= "+AusgabeMitKomma(Stoffmenge)  +" mol  &#8901; "+ AusgabeMitKomma(Reaktionsarray[0][0][3])+" <math><mfrac><mn>g</mn><mn>mol</mn></mfrac></math> = "+AusgabeMitKomma(Reaktionsarray[0][0][5])+"   g";

    
        
    AusgabeText += "<br><br> Probiere es nochmal und klicke dann auf Überprüfen";
    document.getElementById("Hilfestellung").innerHTML=AusgabeText;
}




function SchonVorhanden(A,B){
    SchonArray = [];
    for (i = 0; i< A.length; i++){
        if (SchonArray.includes(A[i][0])){
            } else {   
                SchonArray.push(A[i][0]);
            }
        }
    for (i = 0; i< B.length; i++){
        if (SchonArray.includes(B[i][0])){
            } else {   
                SchonArray.push(B[i][0]);
            }
        }
    return SchonArray;
    }


function ZählArray(ArrayA,SchonArray){
    var ZählArray=[];

    ZählArray = new Array(SchonArray.length).fill(0);
    for (i=0; i<ArrayA.length; i++){
        var Index = SchonArray.indexOf(ArrayA[i][0]);
        if (Index > -1){
            ZählArray[Index] += ArrayA[i][1]
            }
    }
    return ZählArray;
}

function Ausgleich(){
    level = 1;
    Start();
    document.getElementById("AntwortSatz").innerHTML = "";
}

function StoffMBerechnen(){
    level = 3;
    Start();
    document.getElementById("AntwortSatz").innerHTML = "";
}

function MasseBerechnen(){
    level = 4;
    Start();
    document.getElementById("AntwortSatz").innerHTML = "";
}

function NeueAufgabeStarten(){
    level = 0;
    document.getElementById("myTable").innerHTML = "";

    document.getElementById("Bilder").innerHTML="";
    SchonArray = [];
    ZählArrayE = [];
    ZählArrayP = [];
    Stoffmenge;
    Stoffmenge = Math.floor(Math.random()*11+1)/2;
    Nummer = Math.floor(Math.random()*AufgabenArray.length);
    Reaktionsarray = [];
    Reaktionsarray = AufgabenArray[Nummer];
    FarbEinsteller();
    Start();
}

function MolareMassen(){
    level = 2;
    Start();
    document.getElementById("AntwortSatz").innerHTML = "";
}

function SummenformelArray(summenFormel){
            
            const Formel = KoeffizientenVergrößern(summenFormel);
            let teste;
            let Ergebnis = [];
            Ergebnis = Formel.split(/(?=[A-Z])/);
            if (summenFormel.indexOf("^") != -1){
                
            
                let Ladung = Formel.split("^");

                Ergebnis = Ladung[0];
                teste = Ladung[1].match(/[0-9]/g);
                if (teste == null){
                    teste = 1;
                }
                Ladung = Ladung[1].match(/[^0-9]/g);
                if (Ladung[0] == "-"){
                    teste = teste * (-1);
                }
                if (Ladung[0] == "+"){
                    teste = parseInt(teste);
                }
                
            } else if (summenFormel.includes("+") == true){
                teste = 1;
            } else if (summenFormel.includes("-") == true){
                teste = -1;
            } else { teste = 0;}
            

            var summenArray = [];
            for (i=0;i<Ergebnis.length;i++){
                let Element = Ergebnis[i].match(/[a-z]+/gi);
                if (Element == null){
                    break;
                } else {
                let Zahl;
                if (Ergebnis[i].match(/\d+/g) == null){
                    Zahl = 1;
                } else {
                    Zahl = Ergebnis[i].match(/\d+/g);
                }


                summenArray.push([Element[0], parseInt(Zahl)]);
            }
            }
            if((summenArray.length == 1) && (summenArray[0][0] == "e")){
                summenArray.pop();
            }
            summenArray.push(["J",teste]);

            return summenArray;
        }

        function KlammerVersteher(Formel){
            var nummer ;    //Die Zahl nach der Klammer
            var KlammerTeiler =[]; //Array, dass den String teilt (vor der Klammer und in der Klammer)
            var Ausgabe =""; 
            var RestFormel ="";   //Der Sting, der noch nicht durchsucht wurde. 
            RestFormel = Formel;
            while (RestFormel.indexOf(")") != -1) {
            KlammerTeiler = (RestFormel.substring(0,RestFormel.indexOf(")")+1)).split(/[(,)]/,2);
            RestFormel = (RestFormel.substring(RestFormel.indexOf(")")+1,RestFormel.length));
            nummer =parseInt(RestFormel)
            Ausgabe += KlammerTeiler[0];
            for (let i = 0; i<nummer; i++){
                Ausgabe += KlammerTeiler[1];
            }
            nummer = ""+nummer;
            RestFormel = RestFormel.substring(RestFormel.indexOf(nummer)+nummer.length,RestFormel.length);
            }
            Ausgabe += RestFormel;
            return Ausgabe;
            }

        //     function LebensAnzeiger(){
        //     let ReagenzglasBilder = "";
        //     document.getElementById('LebensAnzeige').innerHTML = "";
        //     for (let i=0; i<(Math.min(failCounter,3)); i++){
        //         let img = new Image();
        //         img.className ="Reagenzi";
        //         img.src = "img/Reagenzglas-rot.png";
        //         img.width = 30;
        //         document.getElementById('LebensAnzeige').appendChild(img);
        //     }
        //     for (let i=0; i<(3-failCounter); i++){
        //         let img = new Image();
        //         img.className ="Reagenzi";
        //         img.src = "img/Reagenzglas-grün.png";
        //         img.width = 30;
        //         document.getElementById('LebensAnzeige').appendChild(img);
        //     }
            
        // }

</script>
</body>
<footer>
    <p style="font-size: x-small;" xmlns:cc="http://creativecommons.org/ns#" xmlns:dct="http://purl.org/dc/terms/"><a property="dct:title" rel="cc:attributionURL">Digitaltrainer Stöchiometrie</a> by <a rel="cc:attributionURL dct:creator" property="cc:attributionName">Kevin Reinmuth-Vögeli</a> is licensed under <a href="http://creativecommons.org/licenses/by-nc-sa/4.0/?ref=chooser-v1" target="_blank" rel="license noopener noreferrer" style="display:inline-block;">CC BY-NC-SA 4.0<img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/cc.svg?ref=chooser-v1"><img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/by.svg?ref=chooser-v1"><img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/nc.svg?ref=chooser-v1"><img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/sa.svg?ref=chooser-v1"></a></p>
</footer>
</html>